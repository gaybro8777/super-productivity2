<section class="mat-typography">
  <input placeholder="your task"
         [(ngModel)]="taskTitle">

  <button
    (click)="addTask(taskTitle)"
    [disabled]="!taskTitle"
    *ngIf="!editing">
    Add task
  </button>

  <button
    (click)="updateTask(idToEdit,taskTitle)"
    *ngIf="editing">
    Update
  </button>
  <button
    (click)="cancelEdit()"
    *ngIf="editing">
    Cancel
  </button>


  <ul dnd-sortable-container
      class="task-list"
      [sortableData]="tasks$ | async">
    <li *ngFor="let task of tasks$ | async; let i = index;"
        dnd-sortable
        [sortableIndex]="i"
        class="task"
        [class.is-done]="task.isDone">
      <!--<div class="first-line"-->
      <!--layout="row"-->
      <!--as-sortable-item-handle-->
      <!--layout-align="space-between center"> -->
      <div class="first-line">

        <!--<span class="title">{{ task.title }}</span>-->
        <!--<span>{{task|json}}</span>-->
        <!--<button (click)="editTask(task, task.id)">Edit</button>-->
        <!--<button (click)="toggleDone(task, task.id)">Toggle Done</button>-->
        <!--<button (click)="deleteTask(task.id)">X</button>-->

        <button md-icon-button
                aria-label="is updated"
                tabindex="2"
                (click)="task.showNotes = !task.showNotes;"
                *ngIf="task.isUpdated">
          <!--<md-tooltip>-->
          <!--Click to show updates-->
          <!--</md-tooltip>-->
          <i class="update update-icon"
             flex="none"
             icon="update"></i>
        </button>


        <i class="handle material-icons"
           flex="none">drag_handle</i>


        <button md-icon-button
                (click)="startTask(task.id)"
                aria-label="mark as current"
                tabindex="2"
                *ngIf="!task.isDone && !task.isCurrent">
          <i class="material-icons">play_circle_filled</i>
        </button>

        <button md-icon-button
                (click)="pauseTask(task.id)"
                tabindex="2"
                *ngIf="!task.isDone && task.isCurrent">
          <i class="material-icons">pause_circle_filled</i>
        </button>


        <!--<button md-button-->
        <!--class="md-icon-button original-link-btn"-->
        <!--aria-label="link"-->
        <!--tabindex="2"-->
        <!--target="_blank"-->
        <!--external-link-->
        <!--*ngIf="task.originalLink"-->
        <!--ng-href="{{ task.originalLink }}">-->

        <!--<i icon="link"-->
        <!--*ngIf="task.originalType !=='GITHUB'"-->
        <!--aria-label="link"></i>-->
        <!--<i icon="github-circle"-->
        <!--*ngIf="task.originalType ==='GITHUB'"-->
        <!--aria-label="link"></i>-->
        <!--</button>-->

        <!--<div class="title"-->
             <!--flex="auto"-->
             <!--layout="row"-->
             <!--layout-align="center center">-->
          <!--<span class="text"-->
                <!--tabindex="2"-->
                <!--edit-on-click-on-edit-finished="$ctrl.focusLastFocusedTaskEl(); $ctrl.onChangeTitle(task, isChanged, newVal);"-->
                <!--edit-on-click-ev-id="task.id"-->
                <!--edit-on-click="task.title"></span>-->
        <!--</div>-->

        <div class="time">
          <!--<span *ngIf="task.subTasks.length>0">âˆ‘</span>-->
          <!--<span [innerHtml]="(task.timeSpent|duration) +' / ' + (task.timeEstimate|duration)"></span>-->
        </div>

        <div class="controls">
          <button md-icon-button
                  tabindex="2"
                  [disabled]="task.subTasks && task.subTasks.length>0"
                  aria-label="time estimation"
                  (click)="estimateTime(task)">

            <i class="material-icons"
               aria-label="time estimation">access_time</i>
          </button>
          <button md-icon-button
                  aria-label="add sub task"
                  *ngIf="!isSubTasksDisabled&&!task.isDone"
                  tabindex="2"
                  (click)="addSubTask(task, $event);">

            <i class="material-icons"
               aria-label="add sub task">playlist_add</i>
          </button>
          <button md-icon-button
                  aria-label="notes"
                  tabindex="2"
                  [class.is-active]="task.showNotes"
                  (click)="task.showNotes=!task.showNotes">

            <!--<i icon="{{(task.notes||task.originalKey) ?'insert_comment': 'mode_comment'}}"-->
            <!--aria-label="notes"></i>-->
          </button>
          <button md-icon-button
                  aria-label="delete"
                  tabindex="2"
                  (click)="deleteTask(task, $index)">

            <i icon="delete_forever"
               class="delete-icon"
               aria-label="delete"></i>
          </button>
          <md-checkbox ng-model="task.isDone"
                       tabindex="2"
                       ng-change="onTaskDoneChanged(task)"
                       aria-label="un-/mark as done">
          </md-checkbox>
        </div>
      </div>

      <!--<md-progress-linear md-mode="determinate"-->
      <!--value="{{task.progress}}"></md-progress-linear>-->


      <!--<div class="notes"-->
           <!--*ngIf="task.showNotes===true">-->

        <!--<section *ngIf="task.isUpdated;">-->
          <!--<div class="md-caption">-->
            <!--Changes since last update-->
          <!--</div>-->

          <!--&lt;!&ndash;<ul class="changelog">&ndash;&gt;-->
            <!--&lt;!&ndash;<li *ngFor="let changelogEntry of task.originalChangelog">&ndash;&gt;-->
              <!--&lt;!&ndash;<div *ngIf="changelogEntry.author">&ndash;&gt;-->
                <!--&lt;!&ndash;<em>[<span [innerHtml]="changelogEntry.author"></span>]&ndash;&gt;-->
                  <!--&lt;!&ndash;&lt;!&ndash;<span [innerHtml]="changelogEntry.created| amDateFormat:'Y.MM.DD HH:mm'"></span></em>&ndash;&gt;&ndash;&gt;-->
              <!--&lt;!&ndash;</div>&ndash;&gt;-->
              <!--&lt;!&ndash;<div *ngFor="let change of changelogEntry.items">&ndash;&gt;-->
                <!--&lt;!&ndash;<strong [innerHtml]="change.field"></strong>&ndash;&gt;-->
                <!--&lt;!&ndash;<span *ngIf="change.toString.length"><em>changed to:</em> <span [innerHtml]="change.toString"></span></span></span>&ndash;&gt;-->
              <!--&lt;!&ndash;</div>&ndash;&gt;-->
            <!--&lt;!&ndash;</li>&ndash;&gt;-->
          <!--&lt;!&ndash;</ul>&ndash;&gt;-->
          <!--<button md-raised-button-->
                  <!--(click)="task.isUpdated=false;task.originalChangelog=undefined;task.showNotes=false">-->
            <!--<i class="material-icons">delete</i>-->
            <!--Hide changes-->
          <!--</button>-->
        <!--</section>-->

        <!--<section>-->
          <!--<div class="md-caption"-->
               <!--[innerHtml]="task.originalId ? 'Description': 'Notes'"></div>-->
          <!--<div md-whiteframe="4">-->
            <!--<inline-markdown ng-model="task.notes"-->
                             <!--on-changed="onTaskNotesChanged(newVal, task)"></inline-markdown>-->
          <!--</div>-->
        <!--</section>-->

        <!--<section *ngIf="task.status.length > 0 || task.originalStatus.length > 0"-->
                 <!--class="status">-->
          <!--<div class="md-caption">Status: <span [innerHtml]="task.originalStatus.name || task.originalStatus"></span>-->
            <!--<i icon="arrow_forward"-->
               <!--*ngIf="task.status.length > 0"-->
               <!--aria-label="arrow forward"></i>-->
            <!--<span [innerHtml]="task.status"></span>-->
          <!--</div>-->
        <!--</section>-->

        <!--<section *ngIf="task.originalAssigneeKey"-->
                 <!--class="assignee">-->
          <!--<div class="md-caption">Assignee: <span [innerHtml]="task.originalAssigneeKey"></span></div>-->
        <!--</section>-->

        <!--<section *ngIf="task.originalAttachment.length > 0">-->
          <!--<collapsible title="Attachments ({{ task.originalAttachment.length }})">-->
            <!--<ul class="attachments">-->
              <!--<li ng-repeat="attachment in task.originalAttachment">-->
                <!--<a href="{{ attachment}}"-->
                   <!--external-link-->
                   <!--target="_blank"-->
                   <!--class="md-accent">{{ attachment}}</a>-->
                <!--<a href="{{ attachment}}"-->
                   <!--download="{{ attachment}}"-->
                   <!--class="md-accent">-->
                  <!--<i icon="file_download"-->
                     <!--aria-label="download file directly"></i>-->
                <!--</a>-->
              <!--</li>-->
            <!--</ul>-->
          <!--</collapsible>-->
        <!--</section>-->

        <!--<section *ngIf="task.originalComments.length > 0">-->
          <!--<collapsible title="Comments ({{ task.originalComments.length }})">-->
            <!--<md-divider></md-divider>-->
            <!--<ul class="comments">-->
              <!--<li ng-repeat="comment in task.originalComments"-->
                  <!--class="comment">-->
                <!--<strong class="author">[<span [innerHtml]="comment.author"></span>]: </strong>-->
                <!--<span marked="comment.body"></span>-->
              <!--</li>-->
            <!--</ul>-->
          <!--</collapsible>-->
        <!--</section>-->

      <!--</div>-->

      <!--<sub-task-list ng-if="task.subTasks.length > 0"-->
                     <!--allow-task-selection="{{$ctrl.allowTaskSelection}}"-->
                     <!--current-task-id="$ctrl.currentTaskId"-->
                     <!--task="task"></sub-task-list>-->
    </li>
  </ul>
</section>